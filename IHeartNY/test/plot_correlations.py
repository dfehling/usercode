from ROOT import *

gStyle.SetOptStat(000000)
gStyle.SetPaintTextFormat( '.2f' )

gStyle.SetPadRightMargin(0.12);
gStyle.SetPadLeftMargin(0.12);

labels = ['beta_signal', 'btag', 'jec', 'jer', 'lumi', 'rate_qcd', 'rate_st', 'rate_vjets', 'toptag']


#pdfname = "CT10_nom"
#pdfname = "MSTW_nom"
pdfname = "NNPDF_nom"


### CT10
if pdfname=="CT10_nom": 
    #cov = [[  7.55608435e-03,  -1.94122033e-02,  -8.87050992e-03,
    #          3.85588288e-03,  -2.01439882e-02,  -2.21803682e-02,
    #          9.06988020e-04,   1.72079187e-03,  -3.10536397e-02],
    #       [ -1.94122033e-02,   9.08078658e-01,  -2.80519658e-03,
    #         -2.34470310e-03,   2.59747792e-03,   5.36842130e-02,
    #          1.61452726e-03,   1.39863643e-02,   8.37091592e-02],
    #       [ -8.87050992e-03,  -2.80519658e-03,   1.39007482e-01,
    #         -5.36582209e-02,   3.93566401e-03,   2.29408586e-02,
    #         -4.85979135e-03,  -5.20007301e-02,   2.95633816e-02],
    #       [  3.85588288e-03,  -2.34470310e-03,  -5.36582209e-02,
    #          4.41862340e-01,  -8.85610966e-04,  -1.98216642e-02,
    #          8.34078508e-03,   1.17039243e-02,  -1.79549155e-02],
    #       [ -2.01439882e-02,   2.59747792e-03,   3.93566401e-03,
    #         -8.85610966e-04,   1.01153585e+00,  -6.10480570e-02,
    #         -2.48937598e-02,  -6.64934901e-02,   4.49174626e-03],
    #       [ -2.21803682e-02,   5.36842130e-02,   2.29408586e-02,
    #         -1.98216642e-02,  -6.10480570e-02,   2.07375611e-01,
    #         -7.64241099e-02,  -2.95173949e-02,   1.07626804e-01],
    #       [  9.06988020e-04,   1.61452726e-03,  -4.85979135e-03,
    #          8.34078508e-03,  -2.48937598e-02,  -7.64241099e-02,
    #          7.14888543e-01,  -5.39724472e-03,  -1.73863376e-02],
    #       [  1.72079187e-03,   1.39863643e-02,  -5.20007301e-02,
    #          1.17039243e-02,  -6.64934901e-02,  -2.95173949e-02,
    #         -5.39724472e-03,   3.82222223e-02,   2.00822710e-03],
    #       [ -3.10536397e-02,   8.37091592e-02,   2.95633816e-02,
    #         -1.79549155e-02,   4.49174626e-03,   1.07626804e-01,
    #         -1.73863376e-02,   2.00822710e-03,   1.66776380e-01]]

    cov = [[  9.05365503e-03,  -2.26167062e-02,  -1.10718089e-02,
          1.02715849e-02,  -1.80938768e-02,  -2.21967679e-02,
          6.31413545e-04,   2.20490710e-04,  -3.74010858e-02],
       [ -2.26167062e-02,   9.06567780e-01,  -2.01937503e-02,
         -1.63880353e-02,  -5.60742616e-04,   6.20487602e-02,
         -2.63189059e-03,   2.46679726e-02,   1.01847684e-01],
       [ -1.10718089e-02,  -2.01937503e-02,   1.96296969e-01,
         -6.16290730e-02,   5.66787428e-03,   9.09031867e-03,
         -2.74821928e-03,  -7.25971888e-02,   2.64643673e-02],
       [  1.02715849e-02,  -1.63880353e-02,  -6.16290730e-02,
          5.08330690e-01,  -1.35999210e-03,  -2.58750833e-02,
         -8.44861502e-03,   5.65018572e-03,  -4.45579541e-02],
       [ -1.80938768e-02,  -5.60742616e-04,   5.66787428e-03,
         -1.35999210e-03,   1.01560916e+00,  -4.14777203e-02,
         -2.24701407e-02,  -6.63948847e-02,   5.14421481e-04],
       [ -2.21967679e-02,   6.20487602e-02,   9.09031867e-03,
         -2.58750833e-02,  -4.14777203e-02,   1.21766364e-01,
         -5.34037285e-02,  -1.03241930e-02,   1.01988392e-01],
       [  6.31413545e-04,  -2.63189059e-03,  -2.74821928e-03,
         -8.44861502e-03,  -2.24701407e-02,  -5.34037285e-02,
          6.94910910e-01,  -6.82834925e-03,  -1.00556180e-02],
       [  2.20490710e-04,   2.46679726e-02,  -7.25971888e-02,
          5.65018572e-03,  -6.63948847e-02,  -1.03241930e-02,
         -6.82834925e-03,   4.78805856e-02,   1.38686795e-02],
       [ -3.74010858e-02,   1.01847684e-01,   2.64643673e-02,
         -4.45579541e-02,   5.14421481e-04,   1.01988392e-01,
         -1.00556180e-02,   1.38686795e-02,   1.87349122e-01]]

### MSTW
if pdfname=="MSTW_nom": 
    cov = [[  8.87791691e-03,  -2.25847691e-02,  -1.09197979e-02,
          1.00516374e-02,  -1.78280500e-02,  -2.18990864e-02,
          7.21540146e-04,   3.68112055e-04,  -3.72393125e-02],
       [ -2.25847691e-02,   9.07111865e-01,  -1.98552662e-02,
         -1.60321983e-02,  -5.82759916e-04,   6.22475190e-02,
         -3.04429475e-03,   2.40893562e-02,   1.03098018e-01],
       [ -1.09197979e-02,  -1.98552662e-02,   1.95255054e-01,
         -6.17678824e-02,   5.64260229e-03,   9.04865774e-03,
         -2.49523188e-03,  -7.20516950e-02,   2.68195648e-02],
       [  1.00516374e-02,  -1.60321983e-02,  -6.17678824e-02,
          5.06710363e-01,  -1.34311610e-03,  -2.57878050e-02,
         -8.34329037e-03,   6.14257634e-03,  -4.44758398e-02],
       [ -1.78280500e-02,  -5.82759916e-04,   5.64260229e-03,
         -1.34311610e-03,   1.01561085e+00,  -4.14938284e-02,
         -2.24667718e-02,  -6.63772008e-02,   4.79333234e-04],
       [ -2.18990864e-02,   6.22475190e-02,   9.04865774e-03,
         -2.57878050e-02,  -4.14938284e-02,   1.20661474e-01,
         -5.32924801e-02,  -1.06589072e-02,   1.02118064e-01],
       [  7.21540146e-04,  -3.04429475e-03,  -2.49523188e-03,
         -8.34329037e-03,  -2.24667718e-02,  -5.32924801e-02,
          6.94517127e-01,  -6.85862392e-03,  -1.05427301e-02],
       [  3.68112055e-04,   2.40893562e-02,  -7.20516950e-02,
          6.14257634e-03,  -6.63772008e-02,  -1.06589072e-02,
         -6.85862392e-03,   4.72778410e-02,   1.30277085e-02],
       [ -3.72393125e-02,   1.03098018e-01,   2.68195648e-02,
         -4.44758398e-02,   4.79333234e-04,   1.02118064e-01,
         -1.05427301e-02,   1.30277085e-02,   1.89011967e-01]]

### MSTW
if pdfname=="NNPDF_nom": 
    cov = [[  7.46194886e-03,  -1.82716119e-02,  -7.42212657e-03,
          7.79573672e-03,  -1.73723255e-02,  -1.61886120e-02,
          1.27579329e-03,   3.47442761e-04,  -3.33012574e-02],
       [ -1.82716119e-02,   9.09490337e-01,  -2.21690330e-02,
         -1.38322392e-02,  -7.53094216e-04,   4.42801235e-02,
         -3.37600279e-03,   2.03313905e-02,   8.82802014e-02],
       [ -7.42212657e-03,  -2.21690330e-02,   1.75457135e-01,
         -4.63440092e-02,   4.75747101e-03,   9.24388358e-04,
         -4.45702144e-03,  -6.36412591e-02,   1.62857413e-02],
       [  7.79573672e-03,  -1.38322392e-02,  -4.63440092e-02,
          5.09870723e-01,  -7.89909864e-04,  -1.86059558e-02,
         -8.08965740e-03,   1.29000880e-03,  -3.87273228e-02],
       [ -1.73723255e-02,  -7.53094216e-04,   4.75747101e-03,
         -7.89909864e-04,   1.01569262e+00,  -4.17109126e-02,
         -2.28121385e-02,  -6.59939294e-02,  -2.69038728e-04],
       [ -1.61886120e-02,   4.42801235e-02,   9.24388358e-04,
         -1.86059558e-02,  -4.17109126e-02,   9.11651203e-02,
         -5.03770018e-02,  -1.02496237e-02,   8.23637400e-02],
       [  1.27579329e-03,  -3.37600279e-03,  -4.45702144e-03,
         -8.08965740e-03,  -2.28121385e-02,  -5.03770018e-02,
          6.88453497e-01,  -5.90598873e-03,  -1.46961907e-02],
       [  3.47442761e-04,   2.03313905e-02,  -6.36412591e-02,
          1.29000880e-03,  -6.59939294e-02,  -1.02496237e-02,
         -5.90598873e-03,   4.22420859e-02,   1.17968445e-02],
       [ -3.33012574e-02,   8.82802014e-02,   1.62857413e-02,
         -3.87273228e-02,  -2.69038728e-04,   8.23637400e-02,
         -1.46961907e-02,   1.17968445e-02,   1.84830196e-01]]


nvars = len(cov[0])
corhist = TH2F('corhist', '', nvars, 0, nvars, nvars, 0, nvars )

for x in xrange(nvars) :
    corhist.GetXaxis().SetBinLabel( x+1, labels[x] )
    corhist.GetYaxis().SetBinLabel( x+1, labels[x] )
    
for irow in xrange(nvars) :
    for icol in xrange( nvars) :
        correlation = cov[irow][icol] / ( sqrt(cov[irow][irow]) * sqrt(cov[icol][icol]) )
        corhist.SetBinContent( irow+1, icol+1, correlation)

c = TCanvas('c', 'c', 700, 600)
corhist.SetMaximum(1.0)
corhist.SetMinimum(-1.0)
corhist.Draw('colz text')
    

c.Print("correlations_"+pdfname+".pdf")
c.Print("correlations_"+pdfname+".png")


