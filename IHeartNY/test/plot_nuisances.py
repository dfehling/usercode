from ROOT import *
from array import array

gStyle.SetOptStat(000000)
gStyle.SetPadTickX(1);
gStyle.SetPadTickY(1);

pdfnames = ["CT10_nom",
            "CT10_pdfup",
            "CT10_pdfdown",
            "MSTW_nom",
            "MSTW_pdfup",
            "MSTW_pdfdown",
            "NNPDF_nom",
            "NNPDF_pdfup",
            "NNPDF_pdfdown",
            "scaleup",
            "scaledown"]
channels = ["mu", "el"]

for pdfname in pdfnames :
    for ich in channels :
        ### CT10 nom, mu channel
        if pdfname=="CT10_nom" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.8231015858278314, 0.74081695436967998)], 'toptag': [(0.42574904063033192, 0.41608766333721209)], 'btag': [(0.050661828090769509, 0.94981731627555666)], 'beta_signal': [(0.692940578625582, 0.09415106167436682)], 'jec': [(1.0072159878986491, 0.69752384199588768)], 'rate_vjets': [(-0.39655082450649826, 0.17924632733755214)], '__nll': [-35066.337652312679], 'lumi': [(-0.08709103548727283, 1.0077173837796483)], 'rate_qcd': [(-0.20515837101804504, 0.34538901245318748)], 'rate_st': [(-0.86452857009309703, 0.84005156634810341)]}}
            
        ### CT10 pdfup, mu channel
        if pdfname=="CT10_pdfup" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.7979466178294612, 0.73966352358148069)], 'toptag': [(0.26821527374707127, 0.42922444682365624)], 'btag': [(-0.118107887079325, 0.95344985885481059)], 'beta_signal': [(0.57548454997678511, 0.082434181565950504)], 'jec': [(0.99104264234143558, 0.67857791231179532)], 'rate_vjets': [(-0.48756165388168532, 0.19085481484326411)], '__nll': [-35070.721740552413], 'lumi': [(-0.089333279903490104, 1.0078354037391124)], 'rate_qcd': [(-0.15223682236515632, 0.33444587711970658)], 'rate_st': [(-0.83944993078005059, 0.8436267400382198)]}}

        ### CT10 pdfdown, mu channel
        if pdfname=="CT10_pdfdown" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.8126781899088851, 0.74002185734267167)], 'toptag': [(0.55825661146093652, 0.40542207008536857)], 'btag': [(0.16355581970189423, 0.94845635512475635)], 'beta_signal': [(0.8180007173141195, 0.1066673577925541)], 'jec': [(0.98353384193757598, 0.72592890894177997)], 'rate_vjets': [(-0.32826804253655878, 0.17439917059185184)], '__nll': [-35064.38431886227], 'lumi': [(-0.087031261828743003, 1.00761108132322)], 'rate_qcd': [(-0.26249672043097411, 0.35757048957162446)], 'rate_st': [(-0.89641626309094347, 0.83596751458014096)]}}

        ### MSTW nom, mu channel
        if pdfname=="MSTW_nom" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.8090827605228754, 0.74082038061436883)], 'toptag': [(0.4295340219956279, 0.41760115310767154)], 'btag': [(0.046605448339157418, 0.94997237971952198)], 'beta_signal': [(0.68285346988279816, 0.093189369781227938)], 'jec': [(0.975594582059232, 0.70794213693335861)], 'rate_vjets': [(-0.38007869816214318, 0.17908306627369966)], '__nll': [-35066.168153537947], 'lumi': [(-0.08601231970445547, 1.0077413878027335)], 'rate_qcd': [(-0.19405781021931748, 0.34337029028303495)], 'rate_st': [(-0.86941203107251397, 0.84228954107506826)]}}

        ### MSTW pdfup, mu channel
        if pdfname=="MSTW_pdfup" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.7960195192273301, 0.74363523083959537)], 'toptag': [(0.37776268955147257, 0.42433409198645439)], 'btag': [(-0.0056037115498301883, 0.95125298346327603)], 'beta_signal': [(0.5967203909237293, 0.083457790889974626)], 'jec': [(0.88892560866822279, 0.65684315088910039)], 'rate_vjets': [(-0.37857648979191139, 0.17668599941685037)], '__nll': [-35067.388083485188], 'lumi': [(-0.083735860130009665, 1.0077829484478698)], 'rate_qcd': [(-0.14947699619483976, 0.33357512994973226)], 'rate_st': [(-0.8581673320577109, 0.84166815161898456)]}}

        ### MSTW pdfdown, mu channel
        if pdfname=="MSTW_pdfdown" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.7704754072377167, 0.73554081616523159)], 'toptag': [(0.54350831735880156, 0.41349502776545211)], 'btag': [(0.11920271567808688, 0.94949169990649396)], 'beta_signal': [(0.75348426042673911, 0.10028564106668314)], 'jec': [(0.98823335524066769, 0.70243373452183211)], 'rate_vjets': [(-0.32350614718219889, 0.17228289541241257)], '__nll': [-35063.718686977569], 'lumi': [(-0.084772765332962824, 1.0076589058722205)], 'rate_qcd': [(-0.19781539814764584, 0.34250150656154688)], 'rate_st': [(-0.90626498291731605, 0.83550002714480087)]}}

        ### NNPDF nom, mu channel
        if pdfname=="NNPDF_nom" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.8637609903168832, 0.74566515425069846)], 'toptag': [(0.66184367821102852, 0.41115150240922721)], 'btag': [(0.18312063852632079, 0.95035081808944011)], 'beta_signal': [(0.6708941256518075, 0.086209620922281127)], 'jec': [(1.0293725856403686, 0.68427699605479109)], 'rate_vjets': [(-0.33934885657064567, 0.17087470563250934)], '__nll': [-35064.498888146161], 'lumi': [(-0.078803847946530392, 1.0077860990553649)], 'rate_qcd': [(-0.040702246587087362, 0.29248592063937251)], 'rate_st': [(-0.88760018062429702, 0.837015641547321)]}}

        ### NNPDF pdfup, mu channel
        if pdfname=="NNPDF_pdfup" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.8265082746354877, 0.74461153677203029)], 'toptag': [(0.47325631111996252, 0.42536897044471556)], 'btag': [(-0.040812903791273406, 0.95523519651796018)], 'beta_signal': [(0.58662943759157038, 0.080611592280805944)], 'jec': [(0.97804584341905121, 0.66589803648992441)], 'rate_vjets': [(-0.42791999924323426, 0.18042586207552702)], '__nll': [-35070.970771640765], 'lumi': [(-0.083062247424752891, 1.0078554755047651)], 'rate_qcd': [(-0.072948749238761518, 0.30666607469913981)], 'rate_st': [(-0.84866065340550334, 0.84192578034867738)]}}

        ### NNPDF pdfdown, mu channel
        if pdfname=="NNPDF_pdfdown" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.860088931193121, 0.76553717599340576)], 'toptag': [(1.6100590357571549, 0.40880895056794386)], 'btag': [(0.60958198879741921, 0.95896115037521101)], 'beta_signal': [(0.54956680995255636, 0.063063405514601878)], 'jec': [(0.88796245376654936, 0.68788558206879546)], 'rate_vjets': [(-0.38713629516242248, 0.16501932121938581)], '__nll': [-35011.522914244953], 'lumi': [(0.059946096314536478, 1.0077903562876509)], 'rate_qcd': [(0.26982577469036995, 0.23626867201158183)], 'rate_st': [(1.1704562795848881, 0.70314684858401733)]}}

        ### scaleup, mu channel
        if pdfname=="scaleup" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.5938058187740303, 0.74735357226266841)], 'toptag': [(0.25672924544934517, 0.39636739191243653)], 'btag': [(-0.28061519109978489, 0.95216353811019305)], 'beta_signal': [(0.69949404887005473, 0.096925014550706678)], 'jec': [(0.10791216653195121, 0.49982535265221878)], 'rate_vjets': [(-0.28116855104471272, 0.15914214058719381)], '__nll': [-35075.47363235768], 'lumi': [(-0.087407022622522701, 1.0075821260070288)], 'rate_qcd': [(-0.43077942055495555, 0.42016168852569957)], 'rate_st': [(-0.84861253834573169, 0.84373968486607198)]}}

        ### scaledown, mu channel
        if pdfname=="scaledown" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.3047044480164351, 0.73150534071194095)], 'toptag': [(0.79993245433598159, 0.4061828501017879)], 'btag': [(-0.033776808028694344, 0.95769619033967579)], 'beta_signal': [(0.73431425691998009, 0.094293452303840675)], 'jec': [(0.36854341946456781, 0.70382667660229281)], 'rate_vjets': [(-0.38267066602487831, 0.17789122451245024)], '__nll': [-35061.225196303487], 'lumi': [(-0.087034621612177496, 1.0078802684100208)], 'rate_qcd': [(-0.030346180830474263, 0.28674359376160385)], 'rate_st': [(-0.98141611665769057, 0.83276296355828794)]}}

        ### CT10 nom, el channel
        if pdfname=="CT10_nom" and ich=="el": 
            ttbar_list = {'TTbar': {'jer': [(-1.1505693663529337, 0.72567077783896594)], 'toptag': [(0.39485298416177705, 0.26503867984374607)], 'btag': [(0.019791922872434371, 0.9401134282565683)], 'beta_signal': [(0.68550368525470073, 0.065729393349628795)], 'jec': [(0.72010929490135378, 0.41399786928193305)], 'rate_vjets': [(0.88014781026653754, 0.13527480155048466)], '__nll': [-55779.851478231372], 'lumi': [(-0.035739028715513869, 1.0139180499382756)], 'rate_qcd': [(-1.0036922804188442, 0.11642601098887934)], 'rate_st': [(-0.86199265549309023, 0.82626393662187736)]}}
            
        ### CT10 pdfup, el channel
        if pdfname=="CT10_pdfup" and ich=="el": 
            ttbar_list = {'TTbar': {'jer': [(-1.1640988767534011, 0.72731807629838019)], 'toptag': [(0.28840754903882904, 0.27230538002798643)], 'btag': [(-0.12934959041909788, 0.94196375210974548)], 'beta_signal': [(0.56825198459831072, 0.057006748628363524)], 'jec': [(0.71286353819435733, 0.41577512903259256)], 'rate_vjets': [(0.85794003565843402, 0.14001850934174334)], '__nll': [-55780.563521921023], 'lumi': [(-0.034827142129875539, 1.0140016426595075)], 'rate_qcd': [(-1.0243543372750343, 0.1178805888007628)], 'rate_st': [(-0.80241170094437964, 0.83212970890266591)]}}

        ### CT10 pdfdown, el channel
        if pdfname=="CT10_pdfdown" and ich=="el": 
            ttbar_list = {'TTbar': {'jer': [(-1.1468271844629123, 0.72468952907797923)], 'toptag': [(0.48066275300649547, 0.26023978069668446)], 'btag': [(0.14604866968076721, 0.93931660206182788)], 'beta_signal': [(0.81258035046978239, 0.075404377342073947)], 'jec': [(0.72733906842994533, 0.41331762324046306)], 'rate_vjets': [(0.88875228403060214, 0.13269974122218678)], '__nll': [-55778.886717815833], 'lumi': [(-0.037178976180436703, 1.0138640801338752)], 'rate_qcd': [(-0.98638342712551141, 0.11522384944585182)], 'rate_st': [(-0.90325598458885337, 0.82209154218449587)]}}

        ### MSTW nom, el channel
        if pdfname=="MSTW_nom" and ich=="el": 
            ttbar_list = {'TTbar': {'jer': [(-1.1794760806393376, 0.724438169752326)], 'toptag': [(0.38965294898279712, 0.2656861086250718)], 'btag': [(0.00508068613728786, 0.94008881270969857)], 'beta_signal': [(0.67754718379790546, 0.065271016595224385)], 'jec': [(0.70340845736996671, 0.41068363055896345)], 'rate_vjets': [(0.89293946196237606, 0.13424663292697261)], '__nll': [-55779.656108039482], 'lumi': [(-0.035161687515879156, 1.013901178193984)], 'rate_qcd': [(-1.0066985719606762, 0.11663341873464746)], 'rate_st': [(-0.84950517907382928, 0.82705466770131031)]}}

        ### MSTW pdfup, el channel
        if pdfname=="MSTW_pdfup" and ich=="el": 
            ttbar_list = {'TTbar': {'jer': [(-1.220693117017692, 0.7248423050509829)], 'toptag': [(0.33690529803922048, 0.27069101979701288)], 'btag': [(-0.10863419636069803, 0.94122383455160397)], 'beta_signal': [(0.59650805196786871, 0.059145880965519426)], 'jec': [(0.68976382629331978, 0.40641421334991484)], 'rate_vjets': [(0.90165010708022708, 0.13479080516257855)], '__nll': [-55779.723190814824], 'lumi': [(-0.030385025168413318, 1.0139301693023517)], 'rate_qcd': [(-1.0149557882691715, 0.11727195190050231)], 'rate_st': [(-0.79995355427244286, 0.83179024333743901)]}}

        ### MSTW pdfdown, el channel
        if pdfname=="MSTW_pdfdown" and ich=="el": 
            ttbar_list = {'TTbar': {'jer': [(-1.2147550819522708, 0.71960401548177921)], 'toptag': [(0.44487683457354649, 0.26191689422474063)], 'btag': [(0.10616185576718745, 0.93915515620974477)], 'beta_signal': [(0.7557143134360409, 0.071266059409446192)], 'jec': [(0.6736098795898412, 0.40546787759606595)], 'rate_vjets': [(0.92098943664654398, 0.13051816280455347)], '__nll': [-55778.559623964298], 'lumi': [(-0.033485959011155642, 1.0138084157664264)], 'rate_qcd': [(-1.0038172376839902, 0.11633906495600488)], 'rate_st': [(-0.87289469982411161, 0.82305405958468592)]}}

        ### NNPDF nom, el channel
        if pdfname=="NNPDF_nom" and ich=="el": 
            ttbar_list = {'TTbar': {'jer': [(0.86448991272372921, 0.49470939008584791)], 'toptag': [(0.41612985416855736, 0.26419356934115346)], 'btag': [(-0.0033903044201494289, 0.93962879565049484)], 'beta_signal': [(0.72060137109808475, 0.068221697009682059)], 'jec': [(0.52255630709228162, 0.45157381550956965)], 'rate_vjets': [(0.85846834339444522, 0.13083512879964862)], '__nll': [-55778.751232441289], 'lumi': [(-0.036336059546679733, 1.0139192190555106)], 'rate_qcd': [(-0.97039580513547941, 0.11291291082528775)], 'rate_st': [(-0.87026926407710548, 0.82416380702827963)]}}

        ### NNPDF pdfup, el channel
        if pdfname=="NNPDF_pdfup" and ich=="el": 
            ttbar_list = {'TTbar': {'jer': [(-1.1670260208554284, 0.72812767519674459)], 'toptag': [(0.34622682715685854, 0.26985079315621219)], 'btag': [(-0.048993601549007185, 0.94158979667530218)], 'beta_signal': [(0.61514545279804933, 0.060653963743523165)], 'jec': [(0.71239194648873971, 0.41390952954783622)], 'rate_vjets': [(0.86705571622191624, 0.13800237749423747)], '__nll': [-55778.986177985273], 'lumi': [(-0.033074852610039798, 1.0139737711716026)], 'rate_qcd': [(-1.0153438840711633, 0.11720343126192836)], 'rate_st': [(-0.80388208080267265, 0.83131788478967084)]}}

        ### NNPDF pdfdown, el channel
        if pdfname=="NNPDF_pdfdown" and ich=="el": 
            ttbar_list = {'TTbar': {'jer': [(-1.1283529840354367, 0.7220116310429826)], 'toptag': [(0.46697406776538203, 0.25945703877091719)], 'btag': [(0.11587007020546262, 0.93890041380194633)], 'beta_signal': [(0.77109160395127607, 0.071389223379801914)], 'jec': [(0.72958227458544711, 0.41340864541393652)], 'rate_vjets': [(0.89922268490144364, 0.13184652581529624)], '__nll': [-55780.487146526539], 'lumi': [(-0.037950478508462338, 1.0138524650925127)], 'rate_qcd': [(-0.98983333693735576, 0.11548226068791351)], 'rate_st': [(-0.92616182193916796, 0.82043014235598188)]}}

        ### scaleup, el channel
        if pdfname=="scaleup" and ich=="el": 
            ttbar_list = {'TTbar': {'jer': [(0.71655079865776428, 0.57060853548668045)], 'toptag': [(0.64698919477342831, 0.26876036654036317)], 'btag': [(-0.058456823820970838, 0.94428767163886285)], 'beta_signal': [(0.57768229113748926, 0.054218616394782093)], 'jec': [(0.61239051502253294, 0.42710623586015128)], 'rate_vjets': [(0.88530425344610364, 0.12458612299952668)], '__nll': [-55761.133887721626], 'lumi': [(-0.024243864059774089, 1.0139369231291768)], 'rate_qcd': [(-0.93626271581908649, 0.111013882133613)], 'rate_st': [(-0.72777437857339522, 0.83067816847349396)]}}

        ### scaledown, el channel
        if pdfname=="scaledown" and ich=="el": 
            ttbar_list = {'TTbar': {'jer': [(-1.3690404907012144, 0.64115856057626919)], 'toptag': [(0.62649038646607214, 0.26746180194942815)], 'btag': [(-0.04669154203290321, 0.94489248993878949)], 'beta_signal': [(0.72669311912691814, 0.068948409648037279)], 'jec': [(0.7562327752627046, 0.36962363784302665)], 'rate_vjets': [(0.8826576365372687, 0.13069378233661175)], '__nll': [-55755.49577981374], 'lumi': [(-0.026060628366922543, 1.0139320992946768)], 'rate_qcd': [(-0.9610459196762895, 0.11360505618359137)], 'rate_st': [(-0.7414923685517385, 0.82996703074120359)]}}

        signal_list = ttbar_list['TTbar']

        nuisances = TGraphErrors()
        gr1sig = TGraphErrors()
        gr2sig = TGraphErrors()

        nPoint = -1
        for systematic in sorted(signal_list.keys()):

            if systematic is '__nll' or systematic is "beta_signal" or systematic is '__cov':
		continue
            nPoint += 1
	
            print systematic, signal_list[systematic][0][0], signal_list[systematic][0][1]

            nuisances.SetPoint(nPoint, signal_list[systematic][0][0], nPoint+0.5)
            nuisances.SetPointError(nPoint, signal_list[systematic][0][1], 0)

            gr1sig.SetPoint(nPoint, 0, nPoint)
            gr1sig.SetPointError(nPoint, 1, 1)	
            gr2sig.SetPoint(nPoint, 0, nPoint)
            gr2sig.SetPointError(nPoint, 2, 1)
	

        # tcanvas
        c1 = TCanvas("c1", "c1", 600, 800)
        c1.Draw()
        c1.SetLeftMargin(0.25)
        c1.SetRightMargin(0.15)

        gr2sig.SetLineWidth(0)
        gr1sig.SetLineWidth(0)
        gr2sig.SetLineColor(kYellow)
        gr1sig.SetLineColor(kGreen)
        gr2sig.SetFillStyle(1001)
        gr2sig.SetFillColor(kYellow)
        
        dummy = TH2F("dummy",";Post-fit nuisance parameter value (#sigma); ",10,-3,3,8,0,8)
        dummy.GetYaxis().SetTitleOffset(3)
        dummy.GetYaxis().SetLabelSize(0.045)
        dummy.GetXaxis().SetTitleSize(0.04)
        
        nBin = 0
        for systematic in sorted(signal_list.keys()):
            if systematic is '__nll' or systematic is 'beta_signal' or systematic is '__cov':
		continue
	
            if systematic is "toptag":
		name = "Top-tagging"
            if systematic=="btag":
		name = "b-tagging"
            if systematic=="lumi":
		name = "Luminosity"
            if systematic=="jec":
		name = "JEC"
            if systematic=="jer":
		name = "JER"
            if systematic=="rate_qcd":
		name = "N(QCD)"
            if systematic=="rate_st":
		name = "N(single top)"
            if systematic=="rate_vjets":
		name = "N(W+jets)"

            dummy.GetYaxis().SetBinLabel(nBin+1, name)
            nBin += 1


        dummy.Draw()
        gr2sig.Draw("5 same")

        gr1sig.SetFillStyle(1001)
        gr1sig.SetFillColor(kGreen)
        gr1sig.Draw("5 same")

        nuisances.SetMarkerStyle(21)
        nuisances.Draw("P same")

        dummy.Draw("same,axis")

        c1.Print("nuisances_"+pdfname+"_"+ich+".pdf")
        c1.Print("nuisances_"+pdfname+"_"+ich+".png")


