from ROOT import *
from array import array

gStyle.SetOptStat(000000)
gStyle.SetPadTickX(1);
gStyle.SetPadTickY(1);

pdfnames = ["CT10_nom",
            "CT10_pdfup",
            "CT10_pdfdown",
            "MSTW_nom",
            "MSTW_pdfup",
            "MSTW_pdfdown",
            "NNPDF_nom",
            "NNPDF_pdfup",
            "NNPDF_pdfdown",
            "scaleup",
            "scaledown"]
channels = ["mu", "el"]

for pdfname in pdfnames :
    for ich in channels :
        ### CT10 nom, mu channel
        if pdfname=="CT10_nom" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.8231037938750525, 0.74082435211433462)], 'toptag': [(0.42597763544270184, 0.41612445902499545)], 'btag': [(0.050852878237549907, 0.94982365530880641)], 'beta_signal': [(0.69276552916602552, 0.094339509723055048)], 'jec': [(1.0070798251229838, 0.69762487500626158)], 'rate_vjets': [(-0.3969858237364346, 0.17942634519316863)], '__nll': [-35066.337012609045], 'lumi': [(-0.079700140298099867, 1.0068830454890001)], 'rate_mu_qcd': [(-0.20824811331746043, 0.34284195918402399)], 'rate_st': [(-0.86473124641146804, 0.84008523139114766)]}}
            
        ### CT10 pdfup, mu channel
        if pdfname=="CT10_pdfup" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.7979249399682424, 0.73965913999667743)], 'toptag': [(0.26829064863648006, 0.42917488758927741)], 'btag': [(-0.11807809024625822, 0.95343370613323986)], 'beta_signal': [(0.57538349570769864, 0.082585613944898606)], 'jec': [(0.99075539507459331, 0.67836219966487998)], 'rate_vjets': [(-0.48790260550925924, 0.19092228122608534)], '__nll': [-35070.721247415429], 'lumi': [(-0.083997205407669182, 1.0069472567600564)], 'rate_mu_qcd': [(-0.15535568336106717, 0.3317690286577113)], 'rate_st': [(-0.83944457511661341, 0.84363209988587684)]}}

        ### CT10 pdfdown, mu channel
        if pdfname=="CT10_pdfdown" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.8126404591405161, 0.74008280009473026)], 'toptag': [(0.55866923103491073, 0.40543772363562952)], 'btag': [(0.16394390020605068, 0.94844174962966532)], 'beta_signal': [(0.81768918908835619, 0.10686189271431934)], 'jec': [(0.98346129074681021, 0.72592782956830149)], 'rate_vjets': [(-0.32892055730818665, 0.1746203754460236)], '__nll': [-35064.383515414564], 'lumi': [(-0.077359901140819434, 1.0068366858937485)], 'rate_mu_qcd': [(-0.26524946569469754, 0.3549830623549205)], 'rate_st': [(-0.89684564988032023, 0.83598672990796508)]}}

        ### MSTW nom, mu channel
        if pdfname=="MSTW_nom" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.8087422081585709, 0.74085622966488773)], 'toptag': [(0.42978661740631297, 0.41765990184725332)], 'btag': [(0.046299137282273174, 0.94995719423298119)], 'beta_signal': [(0.68267661720737416, 0.093378975852078883)], 'jec': [(0.97613361406683019, 0.70813219526233395)], 'rate_vjets': [(-0.38063240501196094, 0.17927968462881866)], '__nll': [-35066.167554554107], 'lumi': [(-0.07861770174550603, 1.0068759222144597)], 'rate_mu_qcd': [(-0.19700806512721339, 0.3407040164469271)], 'rate_st': [(-0.8701680598661643, 0.83973872450418541)]}}

        ### MSTW pdfup, mu channel
        if pdfname=="MSTW_pdfup" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.7959416835935567, 0.74364171219678776)], 'toptag': [(0.37800459827593819, 0.4243473505494203)], 'btag': [(-0.0052895999405939073, 0.95125554784351829)], 'beta_signal': [(0.59658535079628661, 0.083619526137274747)], 'jec': [(0.88891822439182977, 0.65683224947684293)], 'rate_vjets': [(-0.37895597501408285, 0.17687049172126912)], '__nll': [-35067.387631343467], 'lumi': [(-0.078216304757689273, 1.0068864986689281)], 'rate_mu_qcd': [(-0.15230926172222339, 0.33089922530590427)], 'rate_st': [(-0.8583792122286813, 0.84171157337421798)]}}

        ### MSTW pdfdown, mu channel
        if pdfname=="MSTW_pdfdown" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.7705729930431482, 0.73555060736107691)], 'toptag': [(0.54379328141395178, 0.41353633383718957)], 'btag': [(0.1194052174177207, 0.94949791770784631)], 'beta_signal': [(0.75328848625725486, 0.10048850392024666)], 'jec': [(0.98817793846985291, 0.70245483252005758)], 'rate_vjets': [(-0.32393204858872654, 0.17252441929622109)], '__nll': [-35063.718085968845], 'lumi': [(-0.077744303444788401, 1.0068139100047702)], 'rate_mu_qcd': [(-0.20077616129505255, 0.33992030216211805)], 'rate_st': [(-0.90663221346942102, 0.83554845322409743)]}}

        ### NNPDF nom, mu channel
        if pdfname=="NNPDF_nom" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.8637550393973963, 0.74564231455010987)], 'toptag': [(0.66202238426166027, 0.41117402924574797)], 'btag': [(0.18317969812066659, 0.95034241348569071)], 'beta_signal': [(0.67083111701464859, 0.086386762523641525)], 'jec': [(1.0293605480553583, 0.68426250343977657)], 'rate_vjets': [(-0.33945569584273605, 0.17115347230082628)], '__nll': [-35064.498766548975], 'lumi': [(-0.07758990062241411, 1.0067624738309531)], 'rate_mu_qcd': [(-0.043434962235464968, 0.28959891303873864)], 'rate_st': [(-0.88778298984366388, 0.83985833446949365)]}}

        ### NNPDF pdfup, mu channel
        if pdfname=="NNPDF_pdfup" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.8262254912207545, 0.7446496314495058)], 'toptag': [(0.47338167057087338, 0.42534066799019155)], 'btag': [(-0.040468993140821065, 0.95520060884547953)], 'beta_signal': [(0.58656073827627853, 0.080765042799743059)], 'jec': [(0.97817226158634152, 0.66597159468017419)], 'rate_vjets': [(-0.42813475511351379, 0.18060117488918107)], '__nll': [-35070.97054613068], 'lumi': [(-0.080475808731819712, 1.006859215625928)], 'rate_mu_qcd': [(-0.075812865813461458, 0.30376635082744402)], 'rate_st': [(-0.84887116914647331, 0.84196642890945728)]}}

        ### NNPDF pdfdown, mu channel
        if pdfname=="NNPDF_pdfdown" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.8601931647865373, 0.76553654031948526)], 'toptag': [(1.6098473353513976, 0.40881976623583582)], 'btag': [(0.6094414730490022, 0.95895986558304869)], 'beta_signal': [(0.54974664133102236, 0.06320684667051979)], 'jec': [(0.88824838035357212, 0.68811518826718021)], 'rate_vjets': [(-0.38651437739512567, 0.16545685337654426)], '__nll': [-35011.522366010606], 'lumi': [(0.049547197770741735, 1.0061786023595234)], 'rate_mu_qcd': [(0.27188888833830221, 0.23240280335262417)], 'rate_st': [(1.1713530797899188, 0.70355675645749605)]}}

        ### scaleup, mu channel
        if pdfname=="scaleup" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.5936956008992178, 0.74735603611507595)], 'toptag': [(0.25694132544019166, 0.39635818894832919)], 'btag': [(-0.28047615502707418, 0.95215754108596917)], 'beta_signal': [(0.69915978270117329, 0.097076383516318865)], 'jec': [(0.10791492656337173, 0.49986799834744983)], 'rate_vjets': [(-0.28215875446111244, 0.15933274308805948)], '__nll': [-35075.472360555512], 'lumi': [(-0.071765677313326781, 1.0069981453123751)], 'rate_mu_qcd': [(-0.43376667846920308, 0.41795908992486985)], 'rate_st': [(-0.84916093021789785, 0.84371887479320185)]}}

        ### scaledown, mu channel
        if pdfname=="scaledown" and ich=="mu": 
            ttbar_list = {'TTbar': {'jer': [(1.3048729438781832, 0.73154081506803892)], 'toptag': [(0.79978966817513053, 0.40612353224014486)], 'btag': [(-0.034242976548216439, 0.95766131611928806)], 'beta_signal': [(0.73432803044241757, 0.094479398780192736)], 'jec': [(0.36797993246978034, 0.70454276222414658)], 'rate_vjets': [(-0.38274607074635619, 0.17823132728688984)], '__nll': [-35061.22509440752], 'lumi': [(-0.086589336084905558, 1.0068219927125883)], 'rate_mu_qcd': [(-0.033400711516005321, 0.28364445658484205)], 'rate_st': [(-0.98117863869578126, 0.83057035244146304)]}}

        ### CT10 nom, el channel
        if pdfname=="CT10_nom" and ich=="el": 
            ttbar_list = {'TTbar': {'rate_el_qcd': [(-0.97723560137009813, 0.10673869317464912)], 'jer': [(0.85787058274575823, 0.50038268469734903)], 'toptag': [(0.38317102264503328, 0.26602956465879224)], 'btag': [(-0.044333063512410689, 0.94030531138834195)], 'beta_signal': [(0.69001363261681137, 0.066098736053247897)], 'jec': [(0.52084235954213576, 0.45513155734949895)], 'rate_vjets': [(0.83489914193977621, 0.13383671532805944)], '__nll': [-55779.08883858777], 'lumi': [(-0.0022517211077782663, 1.0119240792845723)], 'rate_st': [(-0.86179698743686983, 0.82505279169902501)]}}
            
        ### CT10 pdfup, el channel
        if pdfname=="CT10_pdfup" and ich=="el": 
            ttbar_list = {'TTbar': {'rate_el_qcd': [(-1.0256950285512305, 0.1116620687345911)], 'jer': [(-1.164469448378882, 0.72731291392851094)], 'toptag': [(0.28867524912819803, 0.27230303980725573)], 'btag': [(-0.12845529644111298, 0.94197396802875688)], 'beta_signal': [(0.5676325236293609, 0.056910163212856246)], 'jec': [(0.7128137489129367, 0.41576912451445253)], 'rate_vjets': [(0.85557501976384354, 0.14035079245269544)], '__nll': [-55780.562934552268], 'lumi': [(0.0036891403600445706, 1.0120576679729425)], 'rate_st': [(-0.80291329548774559, 0.8319219579698417)]}}

        ### CT10 pdfdown, el channel
        if pdfname=="CT10_pdfdown" and ich=="el": 
            ttbar_list = {'TTbar': {'rate_el_qcd': [(-0.96055155595595187, 0.10557446449690773)], 'jer': [(0.87177227387990686, 0.49253931277724067)], 'toptag': [(0.47216380058541341, 0.2611178667061011)], 'btag': [(0.085409434880197435, 0.93956183386305703)], 'beta_signal': [(0.8169533397904829, 0.075676805733949637)], 'jec': [(0.52365185713677631, 0.45340550000030932)], 'rate_vjets': [(0.84502433908045582, 0.13113731675371251)], '__nll': [-55778.175019185503], 'lumi': [(-0.0041819102907431089, 1.0118361265606695)], 'rate_st': [(-0.9086723090345562, 0.82059107630828765)]}}

        ### MSTW nom, el channel
        if pdfname=="MSTW_nom" and ich=="el": 
            ttbar_list = {'TTbar': {'rate_el_qcd': [(-1.0079464865143641, 0.11032992220829763)], 'jer': [(-1.1791290157139465, 0.7244574908722009)], 'toptag': [(0.39004332522113416, 0.26570125951324708)], 'btag': [(0.0054019085557134175, 0.94010668121799279)], 'beta_signal': [(0.67676529332228763, 0.065156557966071005)], 'jec': [(0.70353768430528096, 0.41070640849533879)], 'rate_vjets': [(0.89046740963803883, 0.13458491344635007)], '__nll': [-55779.655510208635], 'lumi': [(0.0042262469153344943, 1.0119245105920582)], 'rate_st': [(-0.85073501828581644, 0.82710180021229918)]}}

        ### MSTW pdfup, el channel
        if pdfname=="MSTW_pdfup" and ich=="el": 
            ttbar_list = {'TTbar': {'rate_el_qcd': [(-1.0160936953601907, 0.11100073441705706)], 'jer': [(-1.2205953961884022, 0.72478788798150651)], 'toptag': [(0.33712485479455107, 0.27065021006012918)], 'btag': [(-0.10831926378602427, 0.94119271198366494)], 'beta_signal': [(0.59587420768763244, 0.059035459484704012)], 'jec': [(0.68995428254728408, 0.40643017850024149)], 'rate_vjets': [(0.89930721988612317, 0.13510870505778461)], '__nll': [-55779.722724967192], 'lumi': [(0.0070661188025650645, 1.0119453478764338)], 'rate_st': [(-0.80089230099221242, 0.8292785757902178)]}}

        ### MSTW pdfdown, el channel
        if pdfname=="MSTW_pdfdown" and ich=="el": 
            ttbar_list = {'TTbar': {'rate_el_qcd': [(-0.97512324357945512, 0.10650691602903566)], 'jer': [(0.89931974861190589, 0.47064325346162178)], 'toptag': [(0.43692749719927937, 0.26281008923884014)], 'btag': [(0.040340566083587139, 0.93957658604389693)], 'beta_signal': [(0.76007125398366138, 0.071614537629099195)], 'jec': [(0.4526117133531698, 0.45261052813870112)], 'rate_vjets': [(0.87625492230376878, 0.12961333057851998)], '__nll': [-55777.774366594909], 'lumi': [(-4.814185481504603e-05, 1.0118390074335628)], 'rate_st': [(-0.87779700692896057, 0.82341672662191934)]}}

        ### NNPDF nom, el channel
        if pdfname=="NNPDF_nom" and ich=="el": 
            ttbar_list = {'TTbar': {'rate_el_qcd': [(-0.9717570402058221, 0.10636956877370819)], 'jer': [(0.86408589575473393, 0.49485829851023372)], 'toptag': [(0.4161011279343429, 0.26416610682595598)], 'btag': [(-0.0030892286566196066, 0.93962424565862368)], 'beta_signal': [(0.71993400424560794, 0.068110846171216988)], 'jec': [(0.52253269607137909, 0.45160167920028577)], 'rate_vjets': [(0.85628034565844979, 0.1311522488369109)], '__nll': [-55778.750556994462], 'lumi': [(-0.001494319239577539, 1.0118672805235567)], 'rate_st': [(-0.87101065075270612, 0.82398589489350704)]}}

        ### NNPDF pdfup, el channel
        if pdfname=="NNPDF_pdfup" and ich=="el": 
            ttbar_list = {'TTbar': {'rate_el_qcd': [(-0.98752203577943409, 0.10744892343472871)], 'jer': [(0.82748140325124786, 0.51655454629058628)], 'toptag': [(0.33402397434680203, 0.27106401441866362)], 'btag': [(-0.11436918663783849, 0.9417764730787529)], 'beta_signal': [(0.61927184390859025, 0.061030352869975601)], 'jec': [(0.52358475257161996, 0.45669872575913978)], 'rate_vjets': [(0.82008825698314758, 0.13662594084855012)], '__nll': [-55778.110820310751], 'lumi': [(0.00061267089337223605, 1.0120014352856901)], 'rate_st': [(-0.8022359142192842, 0.83043333331551616)]}}

        ### NNPDF pdfdown, el channel
        if pdfname=="NNPDF_pdfdown" and ich=="el": 
            ttbar_list = {'TTbar': {'rate_el_qcd': [(-0.96495328100708089, 0.10586814062103696)], 'jer': [(0.8895434933013977, 0.48385641964794668)], 'toptag': [(0.45564011526307341, 0.26021881754717718)], 'btag': [(0.053185363426568578, 0.93904256814611398)], 'beta_signal': [(0.77612532216708385, 0.071756189706981499)], 'jec': [(0.51941838084064729, 0.4526353807515493)], 'rate_vjets': [(0.85595110381749495, 0.13033603848134556)], '__nll': [-55779.866025450421], 'lumi': [(-0.0046912503261385035, 1.0118283649898736)], 'rate_st': [(-0.92951712973811829, 0.81909128267630915)]}}

        ### scaleup, el channel
        if pdfname=="scaleup" and ich=="el": 
            ttbar_list = {'TTbar': {'rate_el_qcd': [(-0.95878823996277796, 0.10668912907935652)], 'jer': [(-0.9970854542383083, 0.56304667795187391)], 'toptag': [(0.67506479150487264, 0.26664610613200584)], 'btag': [(0.0058704179629742751, 0.94400780732719491)], 'beta_signal': [(0.57031354501099751, 0.053146647523513724)], 'jec': [(0.79524408592086882, 0.38335405390967969)], 'rate_vjets': [(0.9208611970131888, 0.12590193052295637)], '__nll': [-55761.856067736138], 'lumi': [(0.010856979525518512, 1.0118439496271938)], 'rate_st': [(-0.75255774429435507, 0.8321347020944877)]}}

        ### scaledown, el channel
        if pdfname=="scaledown" and ich=="el": 
            ttbar_list = {'TTbar': {'rate_el_qcd': [(-0.96202163472902635, 0.10711888463813067)], 'jer': [(-1.3693669341098396, 0.64145362362543834)], 'toptag': [(0.62648884024317597, 0.26748256434868045)], 'btag': [(-0.046582305097160819, 0.9449210228004542)], 'beta_signal': [(0.72605458947517465, 0.068848777162027308)], 'jec': [(0.75598905844553066, 0.36961680505639216)], 'rate_vjets': [(0.88041613177086397, 0.13105964551278343)], '__nll': [-55755.495465998247], 'lumi': [(0.0086253027754059543, 1.0118962920946653)], 'rate_st': [(-0.74088230303664671, 0.83220853190906119)]}}

        signal_list = ttbar_list['TTbar']

        nuisances = TGraphErrors()
        gr1sig = TGraphErrors()
        gr2sig = TGraphErrors()

        nPoint = -1
        for systematic in sorted(signal_list.keys()):

            if systematic is '__nll' or systematic is "beta_signal" or systematic is '__cov':
		continue
            nPoint += 1
	
            print systematic, signal_list[systematic][0][0], signal_list[systematic][0][1]

            nuisances.SetPoint(nPoint, signal_list[systematic][0][0], nPoint+0.5)
            nuisances.SetPointError(nPoint, signal_list[systematic][0][1], 0)

            gr1sig.SetPoint(nPoint, 0, nPoint)
            gr1sig.SetPointError(nPoint, 1, 1)	
            gr2sig.SetPoint(nPoint, 0, nPoint)
            gr2sig.SetPointError(nPoint, 2, 1)
	

        # tcanvas
        c1 = TCanvas("c1", "c1", 600, 800)
        c1.Draw()
        c1.SetLeftMargin(0.25)
        c1.SetRightMargin(0.15)

        gr2sig.SetLineWidth(0)
        gr1sig.SetLineWidth(0)
        gr2sig.SetLineColor(kYellow)
        gr1sig.SetLineColor(kGreen)
        gr2sig.SetFillStyle(1001)
        gr2sig.SetFillColor(kYellow)
        
        dummy = TH2F("dummy",";Post-fit nuisance parameter value (#sigma); ",10,-3,3,8,0,8)
        dummy.GetYaxis().SetTitleOffset(3)
        dummy.GetYaxis().SetLabelSize(0.045)
        dummy.GetXaxis().SetTitleSize(0.04)
        
        nBin = 0
        for systematic in sorted(signal_list.keys()):
            if systematic is '__nll' or systematic is 'beta_signal' or systematic is '__cov':
		continue
	
            if systematic is "toptag":
		name = "Top-tagging"
            if systematic=="btag":
		name = "b-tagging"
            if systematic=="lumi":
		name = "Luminosity"
            if systematic=="jec":
		name = "JEC"
            if systematic=="jer":
		name = "JER"
            if systematic=="rate_qcd":
		name = "N(QCD)"
            if systematic=="rate_st":
		name = "N(single top)"
            if systematic=="rate_vjets":
		name = "N(W+jets)"

            dummy.GetYaxis().SetBinLabel(nBin+1, name)
            nBin += 1


        dummy.Draw()
        gr2sig.Draw("5 same")

        gr1sig.SetFillStyle(1001)
        gr1sig.SetFillColor(kGreen)
        gr1sig.Draw("5 same")

        nuisances.SetMarkerStyle(21)
        nuisances.Draw("P same")

        dummy.Draw("same,axis")

        c1.Print("nuisances_"+pdfname+"_"+ich+".pdf")
        c1.Print("nuisances_"+pdfname+"_"+ich+".png")


